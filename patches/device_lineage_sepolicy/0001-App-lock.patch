From 67d594cdc8c963a533f3e1fb4e4301296c9e4ba7 Mon Sep 17 00:00:00 2001
From: jhonboy121 <alfredmathew05@gmail.com>
Date: Sun, 29 Jan 2023 17:18:38 +0100
Subject: [PATCH] sepolicy: Introduce app lock

Signed-off-by: jhonboy121 <alfredmathew05@gmail.com>
Signed-off-by: Pranav Vashi <neobuddy89@gmail.com>
---
 common/private/service.te       | 1 +
 common/private/service_contexts | 1 +
 common/private/system_server.te | 2 ++
 3 files changed, 4 insertions(+)

diff --git a/common/private/service.te b/common/private/service.te
index 86f6e4c..2744b53 100644
--- a/common/private/service.te
+++ b/common/private/service.te
@@ -1,4 +1,5 @@
 type adbroot_service,                   service_manager_type;
+type app_lock_service, system_api_service, system_server_service, service_manager_type;
 type lineage_hardware_service, system_api_service, system_server_service, service_manager_type;
 type lineage_health_interface_service, system_api_service, system_server_service, service_manager_type;
 type lineage_globalactions_service, system_api_service, system_server_service, service_manager_type;
diff --git a/common/private/service_contexts b/common/private/service_contexts
index cd984cb..2d14d29 100644
--- a/common/private/service_contexts
+++ b/common/private/service_contexts
@@ -6,3 +6,4 @@ lineagetrust                              u:object_r:lineage_trust_service:s0
 profile                                   u:object_r:lineage_profile_service:s0
 
 adbroot_service                           u:object_r:adbroot_service:s0
+app_lock                                  u:object_r:app_lock_service:s0
diff --git a/common/private/system_server.te b/common/private/system_server.te
index 322e01d..12020ed 100644
--- a/common/private/system_server.te
+++ b/common/private/system_server.te
@@ -2,6 +2,8 @@ allow system_server storage_stub_file:dir getattr;
 
 allow system_server adbroot_service:service_manager find;
 
+add_service(system_server, app_lock_service);
+
 # Use HALs
 hal_client_domain(system_server, hal_lineage_fastcharge)
 hal_client_domain(system_server, hal_lineage_health)
